<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>修改订单</title>
    <link rel="stylesheet" href="/styles/app.css">
</head>
<body>

<h2>✏️ 修改订单</h2>

<h3>📋 可修改订单</h3>
<div th:if="${#lists.isEmpty(orderList)}">
    <p>暂无订单</p>
</div>

<table border="1" th:if="${!#lists.isEmpty(orderList)}">
    <tr>
        <th>订单号</th>
        <th>订购日期</th>
        <th>订购人</th>
        <th>题名</th>
        <th>作者</th>
        <th>ISBN</th>
        <th>出版社</th>
        <th>文献类型</th>
        <th>订购价</th>
        <th>订购册数</th>
        <th>状态</th>
        <th>操作</th>
        <th>退货</th>
    </tr>
    <tr th:each="order : ${orderList}">
        <td th:text="${order.orderId}"></td>
        <td th:text="${order.orderDate}"></td>
        <td th:text="${order.orderer}"></td>
        <td th:text="${order.title}"></td>
        <td th:text="${order.author}"></td>
        <td th:text="${order.isbn}"></td>
        <td th:text="${order.publisher}"></td>
        <td th:text="${order.docType}"></td>
        <td th:text="${order.unitPrice}"></td>
        <td th:text="${order.quantity}"></td>
        <td th:text="${order.status}"></td>
        <td>
            <a th:if="${order.status == '待验收'}" th:href="@{/acquisition/modify(orderId=${order.orderId})}">修改</a>
            <span th:if="${order.status != '待验收'}">不可修改</span>
        </td>
        <td>
            <a th:if="${order.status == '待验收'}" th:href="@{/acquisition/return/apply(orderId=${order.orderId})}">退货</a>
            <span th:if="${order.status != '待验收'}">不可退货</span>
        </td>
    </tr>
</table>

<hr>

<h3>📝 修改订单信息</h3>
<div th:if="${editingOrder == null}">
    <p>请选择待验收订单进行修改</p>
</div>

<form th:if="${editingOrder != null}" action="/acquisition/modify/update" method="post">
    <p>订单号：<input type="text" name="orderId" th:value="${editingOrder.orderId}" readonly></p>
    <p>题名：<input type="text" th:value="${editingOrder.title}" readonly></p>
    <p>作者：<input type="text" th:value="${editingOrder.author}" readonly></p>
    <p>ISBN：<input type="text" th:value="${editingOrder.isbn}" readonly></p>
    <p>出版社：<input type="text" th:value="${editingOrder.publisher}" readonly></p>
    <p>文献类型：<input type="text" th:value="${editingOrder.docType}" readonly></p>
    <p>订购人：<input type="text" name="orderer" th:value="${editingOrder.orderer}" required></p>
    <p>订购日期：<input type="date" name="orderDate" th:value="${today}" readonly required></p>
    <p>订购册数：<input type="number" name="quantity" min="1" th:value="${editingOrder.quantity}" required></p>
    <p>订购价：<input type="number" step="0.01" name="unitPrice" min="0" th:value="${editingOrder.unitPrice}" required></p>
    <button type="submit">保存修改</button>
</form>

<p><a href="/acquisition">返回采访管理首页</a></p>

</body>
</html>
