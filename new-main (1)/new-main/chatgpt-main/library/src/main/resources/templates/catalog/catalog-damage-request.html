<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>ç”³è¯·æŠ¥æŸ</title>
    <link rel="stylesheet" href="/styles/app.css">
</head>
<body>
<div class="page-layout">
    <div th:replace="fragments/sidebar :: catalogMenu"></div>
    <main class="page-content">
<h1>ğŸ“• ç”³è¯·æŠ¥æŸ</h1>
<p>è¯·é€‰æ‹©æµé€šåº“å›¾ä¹¦å¹¶å¡«å†™æŠ¥æŸä¿¡æ¯ã€‚</p>

<h2>å›¾ä¹¦æµé€šåº“è¡¨</h2>
<table border="1" cellpadding="6">
    <thead>
    <tr>
        <th>ISBN</th>
        <th>ä¹¦å</th>
        <th>å›¾ä¹¦ç¼–å·</th>
        <th>ç¼–ç›®æ—¥æœŸ</th>
        <th>æ“ä½œ</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="book : ${circulationList}">
        <td th:text="${book.isbn}"></td>
        <td th:text="${book.title}"></td>
        <td th:text="${book.bookId}"></td>
        <td th:text="${book.catalogDate}"></td>
        <td>
            <button type="button"
                    class="select-book"
                    th:attr="data-isbn=${book.isbn},data-title=${book.title}">
                ç”³è¯·æŠ¥æŸ
            </button>
        </td>
    </tr>
    </tbody>
</table>

<hr>

<form action="/catalog/damage/request/submit" method="post" id="damage-request-form">
    <div>
        <label>ISBNï¼š</label>
        <input type="text" id="isbn" name="isbn" readonly required>
    </div>
    <div>
        <label>ä¹¦åï¼š</label>
        <input type="text" id="bookName" name="bookName" readonly>
    </div>
    <div>
        <label>æŠ¥æŸåŸå› ï¼š</label>
        <input type="text" name="damageReason" required>
    </div>
    <div>
        <label>ç”³è¯·äººï¼š</label>
        <input type="text" name="applicant" th:value="${currentApplicant}" th:readonly="${currentApplicant != null}" required>
    </div>
    <div>
        <label>æŠ¥æŸæ—¥æœŸï¼š</label>
        <input type="date" name="damageDate" th:value="${today}" readonly required>
    </div>
    <button type="submit">æäº¤ç”³è¯·</button>
</form>

<p>
    <a href="/catalog/index">è¿”å›ç¼–ç›®å­ç³»ç»Ÿ</a>
</p>

<script>
    document.querySelectorAll(".select-book").forEach(function (button) {
        button.addEventListener("click", function () {
            document.getElementById("isbn").value = button.dataset.isbn;
            document.getElementById("bookName").value = button.dataset.title;
            document.getElementById("damage-request-form").scrollIntoView({ behavior: "smooth" });
        });
    });
</script>
    </main>
</div>
</body>
</html>
